<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meine Daten aus Firebase</title>
    <style>
        /* Grundlegende Styling-Regeln für die Optik der Seite */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px;
            background-color: #f0f2f5; /* Helles Grau als Hintergrund */
            color: #333;
            line-height: 1.6;
        }
        h1 {
            color: #2c3e50; /* Dunkles Blau-Grau */
            text-align: center;
            margin-bottom: 30px;
        }
        #data-container {
            max-width: 800px;
            margin: 0 auto;
            background-color: #ffffff; /* Weißer Hintergrund für den Inhaltsbereich */
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); /* Sanfter Schatten */
        }
        ul {
            list-style: none; /* Keine Standard-Listenpunkte */
            padding: 0;
            margin: 0;
        }
        li {
            background-color: #eef2f7; /* Sehr helles Blau für Listenelemente */
            margin-bottom: 15px;
            padding: 15px 20px;
            border-radius: 8px;
            border-left: 5px solid #007bff; /* Blauer Akzentstreifen links */
            display: flex;
            flex-direction: column; /* Elemente untereinander anordnen */
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08); /* Leichter Schatten für Elemente */
        }
        li strong {
            color: #0056b3; /* Dunkleres Blau für Überschriften/Keys */
            margin-right: 8px;
        }
        .error-message {
            color: #dc3545; /* Rot für Fehlermeldungen */
            font-weight: bold;
            text-align: center;
            padding: 15px;
            background-color: #f8d7da; /* Hellroter Hintergrund */
            border: 1px solid #f5c6cb;
            border-radius: 5px;
            margin-top: 20px;
        }
        .info-message {
            color: #6c757d; /* Dunkles Grau für Info-Nachrichten */
            font-style: italic;
            text-align: center;
            padding: 15px;
            background-color: #e2e3e5; /* Hellgrauer Hintergrund */
            border: 1px solid #d6d8db;
            border-radius: 5px;
            margin-top: 20px;
        }
    </style>
    <script type="module">
        // Importiere die benötigten Funktionen von Firebase
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js';
        import { getDatabase, ref, onValue } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js';

        // --- 1. DEINE FIREBASE-PROJEKTKONFIGURATION ---
        // !!! WICHTIG: ERSETZE DIESE PLATZHALTER mit deinen tatsächlichen Firebase-Projektinformationen. !!!
        // Du findest diese in deiner Firebase-Konsole:
        // Gehe zu "Projektübersicht" -> "Projekt-Einstellungen" (Zahnrad-Symbol oben links) -> "Deine Apps" -> Web-App.
        const firebaseConfig = {
            apiKey: "DEINE_API_SCHLÜSSEL", // Beispiel: "AIzaSyC..."
            authDomain: "DEINE_PROJEKT_ID.firebaseapp.com", // Beispiel: "mein-projekt-12345.firebaseapp.com"
            databaseURL: "https://DEINE_PROJEKT_ID-default-rtdb.europe-west1.firebasedatabase.app", // Beispiel: "https://mein-projekt-12345-default-rtdb.europe-west1.firebasedatabase.app" (Region beachten!)
            projectId: "DEINE_PROJEKT_ID", // Beispiel: "mein-projekt-12345"
            storageBucket: "DEINE_PROJEKT_ID.appspot.com", // Beispiel: "mein-projekt-12345.appspot.com"
            messagingSenderId: "DEINE_MESSAGING_SENDER_ID", // Beispiel: "1234567890"
            appId: "DEINE_APP_ID" // Beispiel: "1:234567890:web:abcdef1234567890abcdef"
        };

        // Firebase-App initialisieren
        // Dies stellt die Verbindung zu deinem Firebase-Projekt her.
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        // --- 2. REFERENZ AUF DEN PFAD DEINER DATEN IN FIREBASE ---
        // !!! WICHTIG: PASSE DIESEN PFAD UNBEDINGT AN !!!
        // Dieser String MUSS exakt dem Schlüssel oder Pfad in deiner Firebase Realtime Database entsprechen,
        // unter dem sich deine anzuzeigenden Daten befinden.
        // Beispiele: 'items', 'produkte', 'benutzerliste', 'werte/sensoren'
        const dataRef = ref(database, 'DEIN_DATENPFAD'); 

        /**
         * Lädt Daten aus Firebase in Echtzeit und aktualisiert die Benutzeroberfläche.
         * Verwendet 'onValue', das einmal sofort und bei jeder Datenänderung am Pfad aufgerufen wird.
         */
        function loadAndDisplayData() {
            console.log("Versuche, Daten von Firebase zu laden...");
            const dataContainerElement = document.getElementById('data-container');
            if (!dataContainerElement) {
                console.error("HTML-Element mit ID 'data-container' wurde nicht gefunden. UI kann nicht aktualisiert werden.");
                return;
            }
            // Zeige eine Lade-Nachricht an, während die Daten abgerufen werden
            dataContainerElement.innerHTML = '<p class="info-message">Lade Daten von Firebase...</p>';

            // Registriert einen Listener für Datenänderungen am angegebenen Pfad
            onValue(dataRef, (snapshot) => {
                const data = snapshot.val(); // Holt die Daten als JavaScript-Objekt/Array

                if (data) {
                    // Daten sind vorhanden. Firebase gibt oft ein Objekt von Objekten zurück (z.B. mit Auto-IDs als Keys).
                    // Wir wandeln dies in ein Array von Objekten um, was für die Anzeige in einer Liste oft einfacher ist.
                    const dataArray = Object.keys(data).map(key => ({
                        id: key, // Der Firebase-Key (z.B. die Auto-ID) wird als 'id' hinzugefügt
                        ...data[key] // Alle anderen Eigenschaften des Firebase-Objekts werden übernommen
                    }));

                    console.log("Daten erfolgreich geladen:", dataArray);
                    updateDataListUI(dataArray); // Aktualisiere die Benutzeroberfläche mit den geladenen Daten
                } else {
                    // Keine Daten unter dem angegebenen Pfad gefunden oder der Pfad ist leer.
                    console.warn(`Keine Daten unter dem Pfad '${dataRef.toString().split('/').pop()}' gefunden oder der Pfad ist leer.`);
                    updateDataListUI([]); // Zeige eine leere Liste an
                }
            }, (error) => {
                // Fehlerbehandlung: Ein Problem ist beim Laden der Daten aufgetreten (z.B. Berechtigung, Netzwerk)
                console.error("Fehler beim Laden der Daten von Firebase:", error);
                // Zeige eine detaillierte Fehlermeldung in der UI an
                dataContainerElement.innerHTML = `
                    <p class="error-message">
                        Fehler beim Laden der Daten: ${error.message}.
                        <br>Bitte überprüfe:
                        <br>- Deine Internetverbindung
                        <br>- Die **Firebase Security Rules** für den Pfad '${dataRef.toString().split('/').pop()}'
                        <br>- Den **Datenpfad** in deinem Code (muss exakt stimmen)
                        <br>- Die **Firebase-Konfiguration** im Code
                    </p>
                `;
            });
        }

        /**
         * Aktualisiert das HTML-Element, das die Liste der geladenen Daten anzeigt.
         * @param {Array} items Ein Array von Objekten, das die geladenen Daten darstellt.
         */
        function updateDataListUI(items) {
            const dataContainerElement = document.getElementById('data-container');
            if (!dataContainerElement) return; // Falls das Element aus irgendeinem Grund nicht existiert

            // Lösche den vorherigen Inhalt des Containers
            dataContainerElement.innerHTML = '';

            if (items.length === 0) {
                dataContainerElement.innerHTML = '<p class="info-message">Momentan sind keine Daten verfügbar.</p>';
                return;
            }

            // Erstelle eine ungeordnete Liste (UL) um die Daten darzustellen
            const ul = document.createElement('ul');
            items.forEach(item => {
                const li = document.createElement('li');
                let itemContent = `<strong>Firebase ID:</strong> ${item.id}`; // Der Firebase-Key ist immer dabei

                // Gehe alle Eigenschaften des Objekts durch und zeige sie an
                // Dies ist generisch, d.h. es funktioniert mit beliebigen Datenstrukturen.
                for (const key in item) {
                    // Überspringe die 'id', da sie schon oben behandelt wurde
                    if (key !== 'id' && Object.prototype.hasOwnProperty.call(item, key)) {
                        // Prüfe, ob der Wert ein einfaches Literal ist oder ein komplexeres Objekt
                        if (typeof item[key] !== 'object' || item[key] === null) {
                            itemContent += `<br><strong>${key}:</strong> ${item[key]}`;
                        } else {
                            // Wenn es ein Objekt ist, zeige es als JSON-String an oder implementiere eine tiefere Anzeige
                            itemContent += `<br><strong>${key}:</strong> ${JSON.stringify(item[key])}`;
                        }
                    }
                }
                li.innerHTML = itemContent;
                ul.appendChild(li);
            });

            // Füge die erstellte Liste dem HTML-Container hinzu
            dataContainerElement.appendChild(ul);
        }

        // --- 3. Startpunkt der Anwendung: Daten laden, sobald das Dokument bereit ist ---
        // Stellt sicher, dass 'loadAndDisplayData' erst ausgeführt wird, nachdem das gesamte HTML-Dokument geladen
        // und die DOM-Struktur verfügbar ist.
        document.addEventListener('DOMContentLoaded', loadAndDisplayData);

    </script>
</head>
<body>
    <h1>Meine Daten aus Firebase Realtime Database</h1>
    <div id="data-container">
        </div>
</body>
</html>
